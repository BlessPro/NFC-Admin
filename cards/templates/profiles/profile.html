<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ content.full_name }} | ThinkTech BizCards</title>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&family=Playfair+Display:wght@400;600;700&family=Space+Grotesk:wght@400;500;600;700&family=Sora:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        window.tailwind = window.tailwind || {};
        window.tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            tt: {
                                bg: "#0b0f14",
                                panel: "#141a23",
                                card: "#1a232f",
                                border: "#243041",
                                accent: "#27d3a6",
                                accent2: "#3ab0ff",
                                muted: "#94a3b8",
                            },
                        },
                        fontFamily: {
                            sora: ["Sora", "sans-serif"],
                        },
                    },
                },
        };
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .preview-body {
            background: var(--wallpaper);
            color: var(--text-color);
            font-family: var(--font-links);
            background-size: cover;
            background-position: center;
        }
        .preview-header-text {
            font-family: var(--font-header);
        }
        .preview-bio {
            font-family: var(--font-bio);
        }
        .preview-btn {
            border-radius: var(--button-radius);
            box-shadow: var(--button-shadow);
            font-family: var(--font-links);
        }
        .preview-btn.solid {
            background: var(--button-bg);
            color: var(--button-text);
            border: 1px solid transparent;
        }
        .preview-btn.outline {
            background: transparent;
            border: 1px solid var(--button-bg);
            color: var(--button-bg);
        }
        .preview-btn.glass {
            background: rgba(255, 255, 255, 0.12);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--button-text);
            backdrop-filter: blur(12px);
        }
    </style>
</head>
<body class="min-h-screen font-sora text-slate-100" style="background: radial-gradient(900px circle at 20% -10%, rgba(39, 211, 166, 0.2), transparent 60%), #0b0f14;">
{% if theme.layout == "linktree" %}
<div class="mx-auto flex min-h-screen max-w-md items-center px-4 py-10">
    <div class="w-full max-w-[414px]">
        <div class="relative w-full overflow-hidden rounded-[2.5rem] border border-tt-border bg-tt-card shadow-[0_25px_60px_rgba(0,0,0,0.55)]" style="aspect-ratio: 414 / 896;">
            <div id="public-preview" class="preview-body flex h-full flex-col gap-4 overflow-x-hidden overflow-y-auto rounded-[2.2rem] p-4" data-button-style="{{ theme.button_style|default:'solid' }}" data-button-shadow="{{ theme.button_shadow|default:'subtle' }}" style="--wallpaper: {{ theme.wallpaper|default:'linear-gradient(180deg, #0f172a 0%, #0b0f14 100%)' }}; --text-color: {{ theme.text_color|default:'#f8fafc' }}; --muted-color: rgba(248, 250, 252, 0.7); --button-bg: {{ theme.button_bg|default:theme.primary|default:'#27d3a6' }}; --button-text: {{ theme.button_text|default:'#0b0f14' }}; --button-radius: {{ theme.button_radius|default:'100' }}%; --button-shadow: 0 12px 24px rgba(0, 0, 0, 0.35); --font-header: {{ theme.header_font|default:"'Sora', sans-serif" }}; --font-links: {{ theme.link_font|default:"'Sora', sans-serif" }}; --font-bio: {{ theme.bio_font|default:"'Sora', sans-serif" }}; --name-size: {{ theme.name_size|default:'1.125rem' }}; --bio-size: {{ theme.bio_size|default:'0.75rem' }};">
                <div class="relative h-32 overflow-hidden rounded-[1.6rem] border border-white/10 bg-white/5">
                    {% if profile.logo and theme.header_mode != "text" %}
                    <img class="h-full w-full object-cover" src="{{ profile.logo.url }}" alt="Header" />
                    {% else %}
                    <div class="preview-header-text flex h-full items-center justify-center px-4 text-center text-lg font-semibold text-white">{{ theme.header_text|default:content.company|default:content.full_name|default:"Your headline" }}</div>
                    {% endif %}
                </div>
                <div class="text-center">
                    <div class="relative mx-auto h-16 w-16">
                        {% if profile.logo %}
                        <img class="h-16 w-16 rounded-full border border-white/20 object-cover" src="{{ profile.logo.url }}" alt="{{ content.full_name }}" />
                        {% else %}
                        {% with name=content.full_name|default:profile.customer.full_name %}
                        <div class="flex h-16 w-16 items-center justify-center rounded-full border border-white/20 bg-white/10 text-sm font-semibold" style="border-color: {{ theme.accent|default:'#f59e0b' }}; color: {{ theme.accent|default:'#f59e0b' }};">{{ name|slice:":2"|upper }}</div>
                        {% endwith %}
                        {% endif %}
                    </div>
                    <h4 class="mt-3 font-semibold" style="color: var(--text-color); font-size: var(--name-size, 1.125rem); font-family: var(--font-header);">{{ content.full_name|default:profile.customer.full_name }}</h4>
                    <p class="text-xs" style="color: var(--muted-color);">{{ content.title }}</p>
                    <p class="text-xs" style="color: var(--muted-color);">{{ content.company }}</p>
                    {% if content.bio %}
                    <p class="preview-bio mt-2" style="color: var(--muted-color); font-size: var(--bio-size, 0.75rem);">{{ content.bio }}</p>
                    {% endif %}
                </div>
                <div class="space-y-3 text-sm">
                    {% if content.phone %}
                    <a class="preview-btn solid block px-4 py-2 text-center font-semibold" href="tel:{{ content.phone }}" data-action-type="call" data-action-value="{{ content.phone }}">Call</a>
                    {% endif %}
                    {% if content.whatsapp %}
                    <a class="preview-btn solid block px-4 py-2 text-center font-semibold" href="https://wa.me/{{ content.whatsapp|cut:'+' }}" data-action-type="whatsapp" data-action-value="{{ content.whatsapp }}">WhatsApp</a>
                    {% endif %}
                    {% if content.email %}
                    <a class="preview-btn solid block px-4 py-2 text-center font-semibold" href="mailto:{{ content.email }}" data-action-type="email" data-action-value="{{ content.email }}">Email</a>
                    {% endif %}
                    {% if content.website %}
                    <a class="preview-btn solid block px-4 py-2 text-center font-semibold" href="{{ content.website }}" data-action-type="website" data-action-value="{{ content.website }}">Website</a>
                    {% endif %}
                    <a class="preview-btn outline block px-4 py-2 text-center text-xs font-semibold" href="{{ vcard_url }}" data-action-type="save_contact">Save contact</a>
                </div>
                <div class="space-y-2 text-sm">
                    {% if content.links %}
                        {% for link in content.links %}
                        <a class="preview-btn solid block px-4 py-2 text-center text-xs font-semibold" href="{{ link.url }}" data-action-type="social" data-action-value="{{ link.url }}">{{ link.label|default:link.url }}</a>
                        {% endfor %}
                    {% else %}
                    <div class="preview-btn outline block px-4 py-2 text-center text-xs font-semibold">Add your first link</div>
                    {% endif %}
                </div>
                {% if theme.footer_show|default:True %}
                <div class="mt-auto pt-2 text-center text-[10px] uppercase tracking-[0.2em]" style="color: var(--muted-color);">{{ theme.footer_text|default:"Made by 10minal" }}</div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% else %}
<div class="mx-auto flex min-h-screen max-w-md items-center px-4 py-10">
    <div class="w-full rounded-3xl border border-tt-border bg-tt-panel/80 p-6" style="--primary: {{ theme.primary|default:'#0d6efd' }}; --secondary: {{ theme.secondary|default:'#1f2937' }}; --accent: {{ theme.accent|default:'#f59e0b' }};">
        {% include "profiles/layouts/"|add:profile.template_key|add:".html" %}
    </div>
</div>
{% endif %}
<script>
    const preview = document.getElementById("public-preview");
    if (preview) {
        const style = preview.dataset.buttonStyle || "solid";
        const shadow = preview.dataset.buttonShadow || "subtle";
        const shadowMap = {
            none: "none",
            subtle: "0 8px 18px rgba(0, 0, 0, 0.25)",
            strong: "0 16px 32px rgba(0, 0, 0, 0.45)",
            hard: "0 10px 0 rgba(0, 0, 0, 0.5)",
        };
        const textColor = getComputedStyle(preview).getPropertyValue("--text-color").trim();
        if (textColor.startsWith("#") && textColor.length === 7) {
            const r = parseInt(textColor.slice(1, 3), 16);
            const g = parseInt(textColor.slice(3, 5), 16);
            const b = parseInt(textColor.slice(5, 7), 16);
            preview.style.setProperty("--muted-color", `rgba(${r}, ${g}, ${b}, 0.7)`);
        }
        preview.style.setProperty("--button-shadow", shadowMap[shadow] || shadowMap.subtle);
        preview.querySelectorAll(".preview-btn").forEach((btn) => {
            btn.classList.remove("solid", "glass", "outline");
            btn.classList.add(style);
        });
    }

    const actionUrl = "{{ action_url }}";
    const visitId = "{{ visit_id }}";

    function sendAction(type, value) {
        if (!type || !actionUrl) {
            return;
        }
        const data = new FormData();
        data.append("action_type", type);
        data.append("action_value", value || "");
        if (visitId) {
            data.append("visit_id", visitId);
        }
        if (navigator.sendBeacon) {
            navigator.sendBeacon(actionUrl, data);
            return;
        }
        fetch(actionUrl, { method: "POST", body: data, keepalive: true });
    }

    document.querySelectorAll("[data-action-type]").forEach((el) => {
        el.addEventListener("click", () => {
            sendAction(el.dataset.actionType, el.dataset.actionValue || el.href || "");
        });
    });
</script>
</body>
</html>


