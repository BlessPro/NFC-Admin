{% extends "ops/base.html" %}

{% block content %}
<h3 class="text-2xl font-semibold">Renewals</h3>

<div class="mt-6 space-y-4">
    <div class="rounded-2xl border border-tt-border bg-tt-panel/80 p-6">
        <div class="text-xs uppercase tracking-[0.2em] text-tt-muted">Expiring within 7 days</div>
        <div class="mt-4 space-y-3">
            {% for profile in expiring_7 %}
            <div class="flex flex-wrap items-center justify-between gap-3 rounded-xl border border-tt-border/60 bg-tt-card px-4 py-3 text-sm">
                <div>
                    <div class="font-semibold">{{ profile.customer.full_name }}</div>
                    <div class="text-tt-muted">Expires {{ profile.hosting_expires_at|date:"M d, Y" }}</div>
                </div>
                <form method="post" action="/admin/renewals/{{ profile.id }}/extend/">
                    {% csrf_token %}
                    <button class="rounded-full border border-tt-border px-4 py-2 text-xs font-semibold text-slate-100 hover:border-tt-accent hover:text-tt-accent" type="submit">Extend 1 year</button>
                </form>
            </div>
            {% empty %}
            <div class="text-sm text-tt-muted">No profiles expiring in 7 days.</div>
            {% endfor %}
        </div>
    </div>

    <div class="rounded-2xl border border-tt-border bg-tt-panel/80 p-6">
        <div class="text-xs uppercase tracking-[0.2em] text-tt-muted">Expiring within 30 days</div>
        <div class="mt-4 space-y-3">
            {% for profile in expiring_30 %}
            <div class="flex flex-wrap items-center justify-between gap-3 rounded-xl border border-tt-border/60 bg-tt-card px-4 py-3 text-sm">
                <div>
                    <div class="font-semibold">{{ profile.customer.full_name }}</div>
                    <div class="text-tt-muted">Expires {{ profile.hosting_expires_at|date:"M d, Y" }}</div>
                </div>
                <form method="post" action="/admin/renewals/{{ profile.id }}/extend/">
                    {% csrf_token %}
                    <button class="rounded-full border border-tt-border px-4 py-2 text-xs font-semibold text-slate-100 hover:border-tt-accent hover:text-tt-accent" type="submit">Extend 1 year</button>
                </form>
            </div>
            {% empty %}
            <div class="text-sm text-tt-muted">No profiles expiring in 30 days.</div>
            {% endfor %}
        </div>
    </div>

    <div class="rounded-2xl border border-tt-border bg-tt-panel/80 p-6">
        <div class="text-xs uppercase tracking-[0.2em] text-tt-muted">Expired</div>
        <div class="mt-4 space-y-3">
            {% for profile in expired %}
            <div class="flex flex-wrap items-center justify-between gap-3 rounded-xl border border-tt-border/60 bg-tt-card px-4 py-3 text-sm">
                <div>
                    <div class="font-semibold">{{ profile.customer.full_name }}</div>
                    <div class="text-tt-muted">Expired {{ profile.hosting_expires_at|date:"M d, Y" }}</div>
                </div>
                <form method="post" action="/admin/renewals/{{ profile.id }}/extend/">
                    {% csrf_token %}
                    <button class="rounded-full border border-tt-border px-4 py-2 text-xs font-semibold text-slate-100 hover:border-tt-accent hover:text-tt-accent" type="submit">Extend 1 year</button>
                </form>
            </div>
            {% empty %}
            <div class="text-sm text-tt-muted">No expired profiles.</div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
