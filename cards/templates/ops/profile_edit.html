{% extends "ops/base.html" %}

{% block content %}
<h3 class="text-2xl font-semibold">Edit profile</h3>
<div class="mt-6 grid gap-6 lg:grid-cols-[1.1fr_0.9fr]">
    <div>
        <form method="post" enctype="multipart/form-data" class="space-y-4">
            {% csrf_token %}
            <div class="rounded-2xl border border-tt-border bg-tt-panel/80 p-6">
                <div class="text-xs uppercase tracking-[0.2em] text-tt-muted">Template and Theme</div>
                <div class="mt-4 grid gap-4 md:grid-cols-2">
                    <div>
                        <label class="text-sm text-tt-muted">Template</label>
                        {{ form.template_key }}
                    </div>
                    <div>
                        <label class="text-sm text-tt-muted">Status</label>
                        {{ form.status }}
                    </div>
                    <div>
                        <label class="text-sm text-tt-muted">Mode</label>
                        {{ form.mode }}
                    </div>
                    <div>
                        <label class="text-sm text-tt-muted">Primary</label>
                        {{ form.primary }}
                    </div>
                    <div>
                        <label class="text-sm text-tt-muted">Secondary</label>
                        {{ form.secondary }}
                    </div>
                    <div>
                        <label class="text-sm text-tt-muted">Accent</label>
                        {{ form.accent }}
                    </div>
                    <div class="md:col-span-2">
                        <label class="text-sm text-tt-muted">Logo</label>
                        {{ form.logo }}
                        {% if profile.logo %}
                        <img class="mt-3 h-20 w-20 rounded-full border border-tt-border object-cover" src="{{ profile.logo.url }}" alt="Logo" />
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="rounded-2xl border border-tt-border bg-tt-panel/80 p-6">
                <div class="text-xs uppercase tracking-[0.2em] text-tt-muted">Content</div>
                <div class="mt-4 grid gap-4 md:grid-cols-2">
                    <div>
                        <label class="text-sm text-tt-muted">Full name</label>
                        {{ form.full_name }}
                    </div>
                    <div>
                        <label class="text-sm text-tt-muted">Title</label>
                        {{ form.title }}
                    </div>
                    <div>
                        <label class="text-sm text-tt-muted">Company</label>
                        {{ form.company }}
                    </div>
                    <div>
                        <label class="text-sm text-tt-muted">Phone</label>
                        {{ form.phone }}
                    </div>
                    <div>
                        <label class="text-sm text-tt-muted">WhatsApp</label>
                        {{ form.whatsapp }}
                    </div>
                    <div>
                        <label class="text-sm text-tt-muted">Email</label>
                        {{ form.email }}
                    </div>
                    <div class="md:col-span-2">
                        <label class="text-sm text-tt-muted">Website</label>
                        {{ form.website }}
                    </div>
                    <div class="md:col-span-2">
                        <label class="text-sm text-tt-muted">Bio</label>
                        {{ form.bio }}
                    </div>
                    <div class="md:col-span-2">
                        <label class="text-sm text-tt-muted">Links</label>
                        {{ form.links_text }}
                    </div>
                </div>
            </div>

            <div class="flex flex-wrap gap-3">
                <button class="rounded-full bg-tt-accent px-6 py-2 text-xs font-semibold text-slate-950" type="submit">Save changes</button>
                <a class="rounded-full border border-tt-border px-6 py-2 text-xs font-semibold text-slate-100 hover:border-tt-accent hover:text-tt-accent" href="/admin/profiles/{{ profile.id }}/">Cancel</a>
            </div>
        </form>
    </div>
    <div>
        <div class="rounded-2xl border border-tt-border bg-tt-panel/80 p-6">
            <div class="text-xs uppercase tracking-[0.2em] text-tt-muted">Preview</div>
            <div id="preview" class="mt-4 rounded-2xl border border-tt-border bg-tt-card p-4">
                {% include "profiles/layouts/"|add:profile.template_key|add:".html" %}
            </div>
        </div>
    </div>
</div>
<script>
    const preview = document.getElementById("preview");
    const inputs = [
        document.getElementById("id_primary"),
        document.getElementById("id_secondary"),
        document.getElementById("id_accent"),
        document.getElementById("id_mode"),
    ];
    function updatePreview() {
        const primary = document.getElementById("id_primary").value;
        const secondary = document.getElementById("id_secondary").value;
        const accent = document.getElementById("id_accent").value;
        preview.style.setProperty("--primary", primary);
        preview.style.setProperty("--secondary", secondary);
        preview.style.setProperty("--accent", accent);
    }
    inputs.forEach((input) => input && input.addEventListener("input", updatePreview));
    updatePreview();
</script>
{% endblock %}
